/*!
 * jQuery Plugin for scrollbars
 *
 * @author Luis Serralheiro (https://github.com/lcavadas/scroll2)
 */
!function(i){i.fn.scroll2=function(t){var e,o,n,s,a,h,r,c=i(this),d=0,l=0,u={},g={},p={},m={},f=i.extend({size:7,railColor:"#aaa",barColor:"#000",marginY:2,marginX:0,timeout:1e3},t),b=function(){var i=e.height()/c.height(),t=e.width()/c.width();a.height(Math.floor(100*i)+"%"),a.height(a.height()),r.width(Math.floor(100*t)+"%"),r.width(r.width()),c.height()===e.height()?(a.hide(),s.hide()):(a.show(),s.show()),c.width()===e.width()?(r.hide(),h.hide()):(r.show(),h.show())},v=function(){c.unbind("DOMSubtreeModified",b),i(document).unbind("mouseup",C),c.remove(),o.append(c),e.remove()},w=function(i,t,e,o){("mousemove"!==t.type||t.pageX!==g[e]||t.pageY!==p[e])&&(g[e]=t.pageX,p[e]=t.pageY,i.addClass("active"),u[e]=(new Date).getTime(),window.setTimeout(function(){(new Date).getTime()-u[e]>=f.timeout&&(i.removeClass("active"),"function"==typeof o&&o())},f.timeout))},z=function(i,t){"horizontal"===t?(h.height(f.size+7),r.height(f.size+3),r.css("bottom",f.marginX+2+"px"),w(h,i,t+"rail",function(){r.css("bottom",f.marginX+"px"),h.height(f.size),r.height(f.size)})):(s.width(f.size+7),a.width(f.size+3),a.css("right",f.marginY+2+"px"),w(s,i,t+"rail",function(){a.css("right",f.marginY+"px"),s.width(f.size),a.width(f.size)}))},x=function(i){w(a,i,"verticalbar"),w(r,i,"horizontalbar")},X=function(i,t){x(i),z(i,t)},Y=function(i){0>l?l=0:l>c.height()-e.height()?l=c.height()-e.height():0>d?d=0:d>c.width()-e.width()?d=c.width()-e.width():i.preventDefault(),a.css("top",e.height()*l/c.height()+"px"),r.css("left",e.width()*d/c.width()+"px"),n.scrollTop(l),n.scrollLeft(d)},y=function(i){"touchmove"===i.type?(g.touch&&p.touch&&(d+=i.pageX-g.touch,l+=i.pageY-p.touch),g.touch=i.pageX,p.touch=i.pageY):(d+=i.originalEvent.deltaX,l+=i.originalEvent.deltaY),Y(i)},k=function(i,t){m[t]=!0},C=function(){m={}},D=function(i,t){"horizontal"===t?i.pageX-r.offset().left>0?d+=e.width():d-=e.width():i.pageY-a.offset().top>0?l+=e.height():l-=e.height(),Y(i)},M=function(i){m.vertical&&p.drag?l+=c.height()*(i.pageY-p.drag)/e.height():m.horizontal&&g.drag&&(d+=c.width()*(i.pageX-g.drag)/e.width()),m.vertical||m.horizontal?(Y(i),g.drag=i.pageX,p.drag=i.pageY):(g.drag=void 0,p.drag=void 0)},T=function(){o=c.parent(),e=i('<div class="scroll2"/>'),e.bind("mousewheel touchmove wheel mousemove",x),e.bind("mousewheel touchmove wheel",y),n=i('<div class="scroll2-content"/>'),s=i('<div class="scroll2-rail" style="position: absolute; z-index: 998"/>'),s.width(f.size),s.css("background-color",f.railColor),s.css("top","0"),s.css("right",f.marginY+"px"),s.css("bottom","0"),a=i('<div class="scroll2-bar" style="position: absolute; z-index: 999;"/>'),a.width(f.size),a.css("border-radius",f.size+"px"),a.css("background-color",f.barColor),a.css("top","0"),a.css("right",f.marginY+"px"),h=i('<div class="scroll2-rail" style="position: absolute; z-index: 998"/>'),h.height(f.size),h.css("background-color",f.railColor),h.css("left","0"),h.css("bottom",f.marginX+"px"),h.css("right","0"),r=i('<div class="scroll2-bar" style="position: absolute; z-index: 999;"/>'),r.height(f.size),r.css("border-radius",f.size+"px"),r.css("background-color",f.barColor),r.css("left","0"),r.css("bottom",f.marginX+"px"),i(document).bind("mouseup",C),e.bind("mousemove",M),a.bind("mousemove",function(i){X(i,"vertical")}),a.bind("mousedown",function(i){k(i,"vertical")}),a.bind("dragstart",function(i){i.preventDefault()}),s.bind("mousemove",function(i){X(i,"vertical")}),s.bind("click",function(i){X(i,"vertical")}),s.bind("click",function(i){D(i,"vertical")}),r.bind("mousemove",function(i){X(i,"horizontal")}),r.bind("mousedown",function(i){k(i,"horizontal")}),r.bind("dragstart",function(i){i.preventDefault()}),h.bind("mousemove",function(i){X(i,"horizontal")}),h.bind("click",function(i){X(i,"horizontal")}),h.bind("click",function(i){D(i,"horizontal")}),c.remove(),e.append(n),e.append(s),e.append(a),e.append(h),e.append(r),n.append(c),o.append(e),c.bind("DOMSubtreeModified",b),b()};return T(),i.extend(this,{update:b,destroy:v})}}(jQuery);