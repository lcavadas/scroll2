/*!
 * jQuery Plugin for scrollbars
 *
 * @author Luis Serralheiro (https://github.com/lcavadas/scroll2)
 */
!function(t){t.fn.scroll2=function(i){var o,e,n,a,r,c,s,l,h,d,u,p,g,f,v=t(this),m={},b={},w={},z={},x=0,T=0,y=t.extend(!0,{size:7,railColor:"#aaa",barColor:"#000",timeout:1e3,container:{width:"",height:""},appendTo:void 0,vertical:{active:!0,margin:2,top:0,bottom:0,trigger:{callback:void 0,offset:0}},horizontal:{active:!0,margin:2,left:0,right:0,trigger:{callback:void 0,offset:0}}},i),k=function(){m.throttle=(new Date).getTime(),window.setTimeout(function(){(new Date).getTime()-m.throttle>=500&&D()},500)},D=function(){"function"==typeof y.container.width?o.width(y.container.width()):y.container.width&&o.width(y.container.width),"function"==typeof y.container.height?o.height(y.container.height()):y.container.height&&o.height(y.container.height);var t=o.height()/v.height(),i=o.width()/v.width();r.height(Math.floor(100*t)+"%"),s.width(Math.floor(100*i)+"%"),window.setTimeout(function(){r.height(r.height()||2*y.size),s.width(s.width()||2*y.size)},200),v.height()<=o.height()||!y.vertical.active?(r.hide(),a.hide()):(r.show(),a.show()),v.width()<=o.width()||!y.horizontal.active?(s.hide(),c.hide()):(s.show(),c.show())},C=function(){window.MutationObserver?l.disconnect():v.unbind("DOMSubtreeModified",k),t(window).unbind("resize",k),t(document).unbind("mouseup",j),y.appendTo&&t(y.appendTo).unbind("mousemove",P),v.remove(),e.append(v),o.remove()},M=function(t,i,o,e){("mousemove"!==i.type||i.pageX!==b[o]||i.pageY!==w[o])&&(b[o]=i.pageX,w[o]=i.pageY,t.addClass("active"),m[o]=(new Date).getTime(),window.setTimeout(function(){(new Date).getTime()-m[o]>=y.timeout&&(t.removeClass("active"),"function"==typeof e&&e())},y.timeout))},X=function(t,i){"horizontal"===i?(s.height(y.size+3),s.css("bottom",y.horizontal.margin+2+"px"),M(c,t,i+"rail",function(){s.css("bottom",y.horizontal.margin+"px"),s.height(y.size)})):(r.width(y.size+3),r.css("right",y.vertical.margin+2+"px"),M(a,t,i+"rail",function(){r.css("right",y.vertical.margin+"px"),r.width(y.size)}))},Y=function(t){M(r,t,"verticalbar"),M(s,t,"horizontalbar")},E=function(t,i){Y(t),X(t,i)},O=function(t){0>T?T=0:T>h&&(T=h),0>x?x=0:x>d&&(x=d),(n.scrollTop()!==T||n.scrollLeft()!==x)&&(r.css("top",o.height()*T/v.height()+"px"),s.css("left",o.width()*x/v.width()+"px"),s.is(":visible")&&(n.scrollLeft(x),"function"==typeof y.horizontal.trigger.callback&&d-x<=y.horizontal.trigger.offset&&y.horizontal.trigger.callback()),r.is(":visible")&&(n.scrollTop(T),"function"==typeof y.vertical.trigger.callback&&h-T<=y.vertical.trigger.offset&&y.vertical.trigger.callback()),t.preventDefault())},L=function(t){return"touchstart"===t.type?(b.touch=t.originalEvent.touches[0].pageX,void(w.touch=t.originalEvent.touches[0].pageY)):("touchmove"===t.type?(b.touch&&w.touch&&(x-=t.originalEvent.touches[0].pageX-b.touch,T-=t.originalEvent.touches[0].pageY-w.touch),b.touch=t.originalEvent.touches[0].pageX,w.touch=t.originalEvent.touches[0].pageY):(x+=t.originalEvent.deltaX||0,T+=t.originalEvent.deltaY||0),void O(t))},S=function(i,o){t(document.body).addClass("scroll2-noselect"),z[o]=!0},j=function(){t(document.body).removeClass("scroll2-noselect"),z={}},H=function(t,i){"horizontal"===i?t.pageX-s.offset().left>0?x+=o.width():x-=o.width():t.pageY-r.offset().top>0?T+=o.height():T-=o.height(),O(t)},P=function(t){z.vertical&&w.drag?T+=v.height()*(t.pageY-w.drag)/o.height():z.horizontal&&b.drag&&(x+=v.width()*(t.pageX-b.drag)/o.width()),z.vertical||z.horizontal?(O(t),b.drag=t.pageX,w.drag=t.pageY):(b.drag=void 0,w.drag=void 0)},Q=function(){var t,i;t=f>0?g>T+f:T+f>g,i=p>0?u>x+p:x+p>u,t?T+=f:T=g,i?x+=p:x=u;var o=!1;(i||t)&&(O({preventDefault:function(){o=!0}}),o&&window.setTimeout(function(){Q()},5))},W=function(i,o){var e=t(i),n=5/(o||600);f=n*e.position().top,p=n*e.position().left,g=e.position().top+T,u=e.position().left+x,(0!==f||0!==p)&&window.setTimeout(function(){Q()},5)},q=function(){if(e=v.parent(),o=t('<div class="scroll2"/>'),n=t('<div class="scroll2-content"/>'),o.bind("mousewheel touchmove touchstart wheel mousemove",function(t){Y(t),"mousemove"!==t.type?L(t):t.stopPropagation()}),a=t('<div class="scroll2-rail" style="position: absolute; z-index: 998"/>'),a.width(y.size+7),a.css("background-color",y.railColor),a.css("top","0"),a.css("right",y.vertical.margin+"px"),a.css("bottom","0"),a.css("margin-top",y.vertical.top+"px"),a.css("margin-bottom",y.vertical.bottom+"px"),r=t('<div class="scroll2-bar" style="position: absolute; z-index: 999;"/>'),r.width(y.size),r.css("border-radius",y.size+"px"),r.css("background-color",y.barColor),r.css("top","0"),r.css("right",y.vertical.margin+"px"),r.css("margin-top",y.vertical.top+"px"),r.css("margin-bottom",y.vertical.bottom+"px"),c=t('<div class="scroll2-rail" style="position: absolute; z-index: 998"/>'),c.height(y.size+7),c.css("background-color",y.railColor),c.css("left","0"),c.css("bottom",y.horizontal.margin+"px"),c.css("right","0"),c.css("margin-left",y.horizontal.left+"px"),c.css("margin-right",y.horizontal.right+"px"),s=t('<div class="scroll2-bar" style="position: absolute; z-index: 999;"/>'),s.height(y.size),s.css("border-radius",y.size+"px"),s.css("background-color",y.barColor),s.css("left","0"),s.css("bottom",y.horizontal.margin+"px"),s.css("margin-left",y.horizontal.left+"px"),s.css("margin-right",y.horizontal.right+"px"),t(document).bind("mouseup",j),y.appendTo?t(y.appendTo).bind("mousemove",P):o.bind("mousemove",P),r.bind("mousemove",function(t){E(t,"vertical")}),r.bind("mousedown",function(t){S(t,"vertical")}),r.bind("dragstart",function(t){t.preventDefault()}),a.bind("mousemove",function(t){E(t,"vertical")}),a.bind("click",function(t){E(t,"vertical")}),a.bind("click",function(t){H(t,"vertical")}),s.bind("mousemove",function(t){E(t,"horizontal")}),s.bind("mousedown",function(t){S(t,"horizontal")}),s.bind("dragstart",function(t){t.preventDefault()}),c.bind("mousemove",function(t){E(t,"horizontal")}),c.bind("click",function(t){E(t,"horizontal")}),c.bind("click",function(t){H(t,"horizontal")}),v.remove(),o.append(n),n.append(v),e.append(o),y.appendTo){var i=t(y.appendTo);i.append(a),i.append(r),i.append(c),i.append(s)}else o.append(a),o.append(r),o.append(c),o.append(s);window.MutationObserver?(l=new MutationObserver(k),l.observe(n[0],{subtree:!0,attributes:!0,childList:!0,characterData:!0})):v.bind("DOMSubtreeModified",k),t(window).bind("resize",k),h=n[0].scrollHeight-o.height(),d=n[0].scrollWidth-o.width(),D()};return q(),t.extend(this,{update:D,scrollTo:W,destroy:C})}}(jQuery);